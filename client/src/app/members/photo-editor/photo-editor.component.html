<div class="row">
  @for (photo of member().photos; track photo.id) {
    <div class="col-2">
      <img
        src="{{ photo.url }}"
        alt="photo of user"
        class="img-thumbnail mb-1"
        [class.not-approved]="!photo.isApproved" />
      <div class="text-center img-text" *ngIf="!photo.isApproved">
        <span class="text-danger">Awaiting approval</span>
      </div>
      <div *ngIf="photo.tags?.length" class="small text-muted text-center">
        Tags:
        <span *ngFor="let tag of photo.tags" class="me-1">
          {{ tag.name }}
          <button
            class="btn btn-xs btn-link text-danger p-0"
            (click)="removeTagFromPhoto(photo, tag)">
            &times;
          </button>
        </span>
      </div>
      <div class="text-center">
        <button
          class="btn btn-sm me-1"
          [disabled]="photo.isMain || !photo.isApproved"
          (click)="setMainPhoto(photo)"
          [ngClass]="
            photo.isMain ? 'btn-success active' : 'btn-outline-success'
          ">
          Main
        </button>
        <button
          class="btn btn-sm btn-danger"
          [disabled]="photo.isMain"
          (click)="deletePhoto(photo)">
          <i class="fa fa-trash"></i>
        </button>
      </div>
      <!-- Assign tags to existing photo -->
      <div class="text-center mt-1">
        <button
          class="btn btn-outline-primary btn-sm"
          (click)="assignTagsToPhoto(photo)"
          [disabled]="!selectedTagIds?.length">
          Assign Selected Tags
        </button>
      </div>
    </div>
  }
</div>

<div class="row mt-5">
  <div class="col-md-3">
    <h3>Add Photos</h3>

    <div
      ng2FileDrop
      [ngClass]="{ 'nv-file-over': hasBaseDropZoneOver }"
      (fileOver)="fileOverBase($event)"
      [uploader]="uploader"
      class="card bg-faded p-5 text-center my-drop-zone">
      <i class="fa fa-upload fa-3x"></i>
      Drop photos here
    </div>
    <div class="mt-3">
      <div class="d-flex mb-2 align-items-center">
        <input
          [(ngModel)]="newTagName"
          placeholder="Add new tag"
          class="form-control me-2" />
        <button class="btn btn-success" type="button" (click)="addTag()">
          Add
        </button>
      </div>
      <div>
        <div *ngFor="let tag of allTags" class="d-flex align-items-center mb-1">
          <input
            class="form-check-input me-2"
            type="checkbox"
            [checked]="selectedTagIds.includes(tag.id)"
            (change)="onTagCheckboxChange($event, tag.id)"
            id="tagCheck{{ tag.id }}" />
          <label
            class="form-check-label flex-grow-1"
            [for]="'tagCheck' + tag.id">
            {{ tag.name }}
          </label>
          <button
            class="btn btn-sm btn-danger ms-2"
            type="button"
            (click)="deleteTag(tag)">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>